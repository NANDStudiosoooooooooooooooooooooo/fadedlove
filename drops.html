<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>FADEDCLOTH - UPCOMING DROPS</title>
    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:500|IBM+Plex+Sans:300&display=swap" rel="stylesheet">
    <meta name="description" content="The offical FADEDCLOTH site. Subscribe for updates.">
    <link rel="stylesheet" href="styles/main.css?v=2.21">
    <style>
        body {
            background-color: black;
            margin: 0;
            padding: 0;
            text-transform: uppercase;
        }

        .drop_container {
            font-family: monospace;
            color: grey;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 100%;
            z-index: 11000;
            overflow-x: auto; /* Allows horizontal scrolling */
            white-space: nowrap; /* Prevents wrapping of the text */
        }

        .drop_item {
            color: darkgray;
            display: flex;
            align-items: center;
            width: 100%;
            padding: 10px 0; /* Increased padding for better spacing */
            font-size: 4vw; /* Dynamic font size */
        }

        .drop_upcoming {
            color: darkgray;
        }

        .drop_item:hover .drop_link {
            color: white; /* Hover effect only on drop text */
        }

        .drop_number {
            width: 5%;
            text-align: left;
            font-size: 4vw; /* Match the font size */
        }

        .drop_number_container {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Align to the left */
            justify-content: center;
            height: 100%; /* Align vertically with the text */
            margin-right: 5px; /* Minimal margin to the number */
        }

        .drop_link {
            color: darkgray;
            flex-grow: 1;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            font-size: 4vw; /* Match the font size */
            display: inline-block; /* Keeps the text in a single line */
            padding: 5px; /* Add padding for better appearance */
            min-width: 150px;
            box-sizing: border-box; /* Include padding in the width */
        }

        .drop_time,
        .drop_countdown {
            width: 25%;
            text-align: left; /* Align to the left */
            white-space: nowrap;
        }

        .drop.active-drop {
            color: rgb(255, 178, 226); /* Farbe für den aktiven Drop */
        }

        .drop.active-drop:hover {
            color: white; /* Farbe beim Hover über den aktiven Drop */
        }

        @media (min-width: 500px) {
            .drop_item {
                font-size: 24px; /* Fixed larger size for screens above 500px */
            }
        }

    .newsletter_form {
        display: flex;
        align-items: center;
        justify-content: flex-start;
    }

    /* Stil für das Eingabefeld */
    .newsletter_form input[type="email"] {
        background: none;
        text-overflow: ellipsis;
        border: none;
        color: white;
        font-size: 4vw;
        text-transform: uppercase;
        padding: 5px;
        margin-right: 20px ;
        margin-left: 200px; /* Abstand zwischen NEWSLETTER und Eingabefeld */
        width: 100%; /* Breite des Eingabefelds */
        outline: none;overflow-x: auto; /* Allows horizontal scrolling */
        white-space: nowrap; /* Prevents wrapping of the text */
        text-align: left;
    }

    /* Verstecken des Eingabefelds nach erfolgreicher Eingabe */
    .newsletter_form input[type="email"].hidden {
        display: none;
    }
    </style>
</head>
<body>
    <div class="main-header">
        <div class="top-left nav-link">
            <a href="https://fadedcloth.de/" id="backbutton">MAINPAGE</a>
        </div>
        <div class="logo-container" id="load-container">
            <video autoplay loop muted playsinline class="header-logo top" id="load-obj">
                <source src="media/fadedcloth.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div id="loader" class="loader-container">
            <l-zoomies size="80" stroke="5" bg-opacity="0.1" speed="1.4" color="white"></l-zoomies>
          </div>
    </div>

    <div class="drop_container" id="drops-container">
        <!-- Drop items will be appended here -->
    </div>

    <div class="buttons-container">
        <button id="button1" class="glass-button" data-target="panel1">COLLECTION</button>
        <button id="button2" class="glass-button" data-target="panel2">INFO</button>
        <button id="button3" class="glass-button" data-target="panel3">NEWSLETTER</button>
        <!--<button id="button4" class="glass-button" data-target="panel4">SMS</button>-->
    </div>
    
    <!-- Panel für Button 1 -->
    <div id="panel1" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel1')">X</button>
        <a href="https://shop.fadedcloth.de/?collection=all&hide=FALSE" class="panel-link">SHOP ALL</a>
        <a href="https://shop.fadedcloth.de/?collection=FADEDLOVE&hide=TRUE" class="panel-link">FADEDLOVE</a>
        <a href="https://fadedcloth.de/" class="panel-link">MAINPAGE</a>
    </div>
    
    <!-- Panel für Button 2 -->
    <div id="panel2" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel2')">X</button>
        <div class="social-container">
            <select id="social-select">
                <option value="instagram">INSTAGRAM</option>
                <option value="tiktok">TIKTOK</option>
                <option value="twitter">TWITTER</option>
            </select>
            <a class="underlineonhover" id="social-select-link" href="https://instagram.com/fadedcloth.de">fadedcloth.de</a>
        </div>
        <a href="mailto:help@fadedcloth.de" class="panel-link">CONTACT</a>
        <a href="/legal?id=privacy-policy" class="panel-link">PRIVACY POLICY</a>
        <a href="/legal?id=terms-of-service" class="panel-link">TERMS OF SERVICE</a>
        <div class="copyright">&copy; FADEDCLOTH 2024</div>
    </div>
    
    <!-- Panel für Button 3 (Subscribe Panel) -->
    <div id="panel3" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel3')">X</button>
        <div class="headline">SUBSCRIBE FOR UPDATES</div>
        <form id="emailForm">
            <input 
                type="email" 
                id="email" 
                placeholder="ENTER YOUR EMAIL" 
                class="email-input"
                required 
            />
            <div class="checkbox-container">
                <input type="checkbox" id="termsCheckbox" class="custom-checkbox">
                <label for="termsCheckbox" class="checkbox-label">
                  I ACCEPT THE <a class="href" href="/legal?id=terms-of-service">TERMS</a>
                </label>
            </div>
            <div class="form-buttons">
                <button id="subscribeButton" class="email-button small-button">
                    SUBMIT
                </button>
            </div>
        </form>
    </div>
    
    <div id="panel4" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel4')">X</button>
        <div class="headline">SMS NEWSLETTER</div>
        <form id="smsForm">
            <input 
                type="text" 
                id="phoneNumber" 
                placeholder="ENTER YOUR PHONE NUMBER" 
                class="email-input" 
                required 
            />
            <div class="form-buttons">
                <button id="email-button small-button" class="form-button" type="submit"> <!-- Verwende die gleiche Klasse für den Button -->
                    SUBSCRIBE
                </button>
            </div>
        </form>
        <div id="smsMessage" class="sms-message"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        fetch('/JSON/drops.json?v=1.1')
            .then(response => response.json())
            .then(data => displayDrops(data));

        function displayDrops(drops) {
            const container = document.getElementById('drops-container');
            const now = new Date();
            drops.forEach((drop, index) => {
                const dropDate = new Date(drop.date + 'T' + drop.time + ':00');
                const isUpcoming = dropDate > now;

                const dropElement = document.createElement('div');
                dropElement.className = 'drop_item';

                dropElement.setAttribute('data-drop-date', dropDate.toISOString());

                // Erstellen der Drop-Nummer
                const dropNumberContainer = document.createElement('div');
                dropNumberContainer.className = 'drop_number_container';

                const dropNumberHash = document.createElement('div');
                dropNumberHash.textContent = '#';
                const dropNumber = document.createElement('div');
                dropNumber.textContent = String(index + 1).padStart(2, '0');

                dropNumberContainer.appendChild(dropNumberHash);
                dropNumberContainer.appendChild(dropNumber);

                dropElement.appendChild(dropNumberContainer);

                const dropLink = document.createElement(isUpcoming ? 'span' : 'a');
                dropLink.className = 'drop_link';

                if (isUpcoming) {
                    dropLink.textContent = drop.name 
                        ? `${drop.name} ${getExtendedCountdown(dropDate)} ${formatUpcomingDate(dropDate)}` 
                        : `${getExtendedCountdown(dropDate)} ${formatUpcomingDate(dropDate)}`;
                } else {
                    dropLink.textContent = drop.name + (drop.subname ? ` - ${drop.subname}` : '');
                    if (drop.link) {
                        dropLink.href = drop.link;
                        dropLink.target = "_blank"; // Öffnet den Link in einem neuen Tab
                    }
                }

                dropElement.appendChild(dropLink);
                container.appendChild(dropElement);

                if (isUpcoming) {
                    setInterval(() => {
                        dropLink.textContent = drop.name 
                            ? `${drop.name} ${getExtendedCountdown(dropDate)} ${formatUpcomingDate(dropDate)}`
                            : `${getExtendedCountdown(dropDate)} ${formatUpcomingDate(dropDate)}`;
                    }, 1000);
                }
            });

            addNewsletterInput(drops.length + 1);
        }
    
            // Funktion zur Hinzufügung der Newsletter-Eingabe
            function addNewsletterInput(nextDropNumber) {
                const container = document.getElementById('drops-container');
                
                // Container für Newsletter
                const newsletterContainer = document.createElement('div');
                newsletterContainer.className = 'drop_item';
    
                // #XX für Newsletter
                const dropNumberContainer = document.createElement('div');
                dropNumberContainer.className = 'drop_number_container';
    
                const dropNumberHash = document.createElement('div');
                dropNumberHash.textContent = '#';
                const dropNumber = document.createElement('div');
                dropNumber.textContent = String(nextDropNumber).padStart(2, '0');
    
                dropNumberContainer.appendChild(dropNumberHash);
                dropNumberContainer.appendChild(dropNumber);
                newsletterContainer.appendChild(dropNumberContainer);
    
                // Newsletter Text und Input
                const newsletterLabel = document.createElement('div');
                newsletterLabel.className = 'drop_link';
                newsletterLabel.textContent = 'ENTER EMAIL:';
    
                const emailInput = document.createElement('input');
                emailInput.id = 'email';
                emailInput.className = 'drop_link'; // Selber Style wie die Drops
                emailInput.setAttribute('type', 'email');
                emailInput.setAttribute('placeholder', '');
    
                // Container für die Eingabe und den Text
                const newsletterForm = document.createElement('div');
                newsletterForm.className = 'newsletter_form';
                newsletterForm.appendChild(newsletterLabel);
                newsletterForm.appendChild(emailInput);
    
                // Eingabefeld hinzufügen
                newsletterContainer.appendChild(newsletterForm);
                container.appendChild(newsletterContainer);
    
                // Event Listener für das Drücken von Enter
                emailInput.addEventListener('keypress', function (event) {
                    if (event.key === 'Enter') {
                        event.preventDefault();
                        processSubscription(emailInput.value, newsletterLabel, emailInput);
                    }
                });
            }

            function formatUpcomingDate(date) {
            const options = {
                weekday: 'short', // Wochentag (TUE)
                month: 'short', // Monat (OCT)
                day: '2-digit', // Tag (22)
                year: '2-digit', // Jahr (24)
                hour: '2-digit', // Stunden (12)
                hour12: true // 12-Stunden-Format
            };

            const formattedDate = new Intl.DateTimeFormat('en-US', options).format(date);
            const ampm = date.getHours() >= 12 ? 'PM' : 'AM'; // AM/PM

            // Kombinierung der Informationen im gewünschten Format
            return `${formattedDate.replace(/,\s/g, ' ').replace(/\b\d{4}\b/, '')} UTC+2`.replace(/ +/, ' ').trim(); // Vermeidung doppelter Leerzeichen
        }

        // Erweiterte Countdown-Funktion
        function getExtendedCountdown(date) {
            const now = new Date();
            const diff = date - now;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24)); // Tage
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); // Stunden
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)); // Minuten
            const seconds = Math.floor((diff % (1000 * 60)) / 1000); // Sekunden

            return `${String(days).padStart(2, '0')}:${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
    
            // Funktion zur Verarbeitung der E-Mail-Validierung und Einreichung
            function processSubscription(email, newsletterLabel, emailInput) {
                if (isValidEmail(email)) {
                    fetch("https://subscribe.fadedcloth.de/sub", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({ email: email })
                    })
                    .then(response => response.json())
                    .then(data => {
                        newsletterLabel.textContent = 'THANK YOU!';
                        emailInput.remove(); // Entferne das Eingabefeld nach erfolgreicher Eingabe
                    })
                    .catch(error => {
                        alert("An error occurred: " + error.message);
                    });
                } else {
                    shakeElement(emailInput); // Eingabefeld wackelt bei ungültiger E-Mail
                }
            }
    
            // Funktion zur Überprüfung der E-Mail-Validität
            function isValidEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }
    
            // Funktion um den Shake-Effekt hinzuzufügen
            function shakeElement(element) {
                element.classList.add("shake");
                setTimeout(() => {
                    element.classList.remove("shake");
                }, 500);
            }
    
            // Restliche vorhandene Funktionen (formatUpcomingDate, getExtendedCountdown) bleiben wie oben
        });

        
    </script>
    
    
    
    
    
    <script src="scripts/loader.js" defer></script>
    <script src="scripts/social.js?v=1.2" defer></script>
    <script src="scripts/load-buttons.js?v=1.1" defer></script>
    <script src="scripts/animate.js" defer></script> 
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/zoomies.js" defer></script>
    <script src="scripts/subscribe.js?v=1.2" defer></script>
</body>
</html>
