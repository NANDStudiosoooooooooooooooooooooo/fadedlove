<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FADEDCLOTH</title>
    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:500|IBM+Plex+Sans:300&display=swap" rel="stylesheet">
    <meta name="description" content="The offical FADEDCLOTH site. Subscribe for updates.">
    <script src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js"></script>
    <link rel="stylesheet" href="styles/main.css?v=2.69">

    <style>
        body {
            background-color: black;
            margin: 0;
            padding: 0;
            margin-bottom: 0;
            padding-bottom: 0;
            align-items: left !important;
            justify-content: flex-start;
            overflow: scroll;
        }

        .glas-wrapper{
            margin-top: 100vh ;
            display: flex;
            flex-direction: column;
            width: fit-content;
        }

        .drop_container {
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            font-family: monospace;
            color: #84898E;
            display: flex;
            overflow-x: visible;
            overflow-y: visible;
            flex-direction: column;
            align-items: flex-start;
            width: auto;
            text-transform: uppercase;
            position: relative;
            max-width: auto;
            scrollbar-color: #84898E transparent;
            white-space: nowrap; /* Prevents wrapping of the text */
            
        }

        .drop_container::-webkit-scrollbar {
            height: 6px; /* Set the scrollbar height for horizontal scrolling */
        }
        .drop_container::-webkit-scrollbar-track {
            background: transparent; /* Hide the scrollbar track */
        }
        .drop_container::-webkit-scrollbar-thumb {
            background-color: grey; /* Make the scrollbar handle grey */
            border-radius: 10px; /* Round the scrollbar handle */
            border: 2px solid transparent; /* Create space around the scrollbar handle */
        }

        .drop_container::-webkit-scrollbar-thumb:hover {
            background-color: darkgrey; /* Darken the scrollbar handle on hover */
        }

        .drop_item {
            color: darkgray;
            display: flex;
            align-items: center;
            width: 100%;
            font-size: 4vw; /* Dynamic font size */
        }

        .drop_upcoming {
            color: darkgray;
        }

        .drop_item:hover .drop_link {
            color: white; /* Hover effect only on drop text */
        }

        .collection_container{
            display: flex;
            flex-direction: row;
        }

        .collections_container{
            display: flex;
            flex-direction: column;
        }

        .drop_number {
            width: 5%;
            text-align: left;
            z-index: 12000;
        }

        .drop_number_container {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Align to the left */
            justify-content: center;
            height: auto; /* Align vertically with the text */
            font-size: 2vw;
            padding-right: 10px;
            padding-left: 15px;
            line-height: 1.25;
            width: 5ch;
        }

        .drop_link {
            font-family: monospace;
            color: #84898E;
            flex-grow: 1;
            text-align: left;
            white-space: nowrap;
            font-size: 5.8vw; /* Match the font size */
            display: block;
            width: auto;
            box-sizing: border-box; /* Include padding in the width */
            height: auto;
            line-height: 0.88;
        }

        .drop_link:hover {
            color: white;
        }

        .drop_time,
        .drop_countdown {
            width: 25%;
            text-align: left; /* Align to the left */
            white-space: nowrap;
        }

        .active-drop {
            color: rgb(255, 178, 226); /* Farbe für den aktiven Drop */
        }

        .active-drop:hover {
            color: white; /* Farbe beim Hover über den aktiven Drop */
        }

        @media (min-width: 500px) {
            .newsletter_form input[type="email"] {
                font-size: 5.8vw;
                padding: 5px 0 0 0 ;
                line-height: 0.88;
            }
            .newsletter_form{
                font-size: 5.8vw;
                MAX-HEIGHT: 5.8VW;
                line-height: 0.88;
            }
        }
        
        @media (max-width: 500px) {
            .drop_item {
                font-size: 8.8vw; /* Fixed larger size for screens above 500px */
            }
            .drop_link {
                font-size: 8.8vw;
            }
           .newsletter_form{
                font-size: 8.8vw;
                padding: 0;
            }
            .drop_number_container {
                font-size: 3vw;
            }
            .newsletter_form input[type="email"] {
                MAX-HEIGHT: 8.8VW;
                font-size: 8.8VW;
                padding: 0;
            }
        }

        .newsletter_form {
            display: flex;
            align-items: center;
            justify-content: flex-start;
        }

        /* Stil für das Eingabefeld */
        .newsletter_form input[type="email"] {
            background: none;
            text-overflow: ellipsis;
            border: none;
            color: white;
            text-transform: uppercase;
            margin-right: 10px ;
            margin-left: 10px; /* Abstand zwischen NEWSLETTER und Eingabefeld */
            width: 100%; /* Breite des Eingabefelds */
            max-width: 1200px;
            outline: none;
            overflow-x: auto; /* Allows horizontal scrolling */
            white-space: nowrap; /* Prevents wrapping of the text */
            text-align: left;
            overflow-x: visible;
            height: 100%;
            MAX-HEIGHT: 5.8VW;
            font-size: 5.8VW;
        }

        /* Verstecken des Eingabefelds nach erfolgreicher Eingabe */
        .newsletter_form input[type="email"].hidden {
            display: none;
        }

        .scroll-text {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            text-align: center;
        }


        .scroll-effect{
            width: 100%;
            height: 140px;
            position: fixed;
            bottom: 0px;
            background: linear-gradient(to bottom, transparent, black);
            user-select: none;
            pointer-events: none;
        }

        .dropname {
            width: 7ch;
            min-width: 7ch;
        }
        
        @media (max-width: 500px) {
            .utc {
                display: none;
            }
            .dropname {
                display: none;
            }
            body {
                overflow-x: hidden;
            }
        }

        @media (min-width: 501px) {
            .utc {
                display: inline;
            }
            .dropname {
                display: inline;
            }
            body {
                overflow-x: scroll;
            }
        }

        #news-tab {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background-color: #000000;
        border-top: 1px solid white;
        transition: transform 0.4s ease-in-out;
        z-index: 2222;
        }

        #news-header {
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        clip-path: polygon(0% 0%, 98% 0%, 100% 100%, 0% 100%);
        cursor: pointer;
        }

        #news-headline {
        font-size: 14px;
        font-weight: bold;
        text-transform: uppercase;
        }

        #toggle-arrow {
        font-size: 16px;
        transform: rotate(0deg);
        transition: transform 0.3s ease;
        }

        #news-tab.full-height #toggle-arrow {
        transform: rotate(180deg);
        }

        #news-media {
        width: 100%;
        height: calc(100% - 130px);
        max-height: 100%;
        cursor: pointer;
        align-items: flex-start;
        justify-content: center;
        display: flex;
        }
        /* Zustände */
        #news-tab.collapsed {
            transform: translateY(calc(100% - 50px));
        }

        #news-tab.half-height {
            transform: translateY(calc(50vh - 50px));
        }

        #news-tab.full-height {
            transform: translateY(110px);
        }

        .media {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            cursor: pointer;
        }

    .news-hidden {
        transform: translateY(100%) !important;
    }

    .drop_link.expired {
    text-decoration: line-through;
    color: gray;
}

.drop_link.active {
    color: pink;
    font-weight: bold;
}

.drop_link.upcoming {
    color: black;
    font-style: italic;
}


    </style>

    <script>
        window.addEventListener('scroll', function() {
        var scrollPosition = window.scrollY;
        var element = document.querySelector('.scroll-text');
        if (scrollPosition > 0) {
            element.classList.replace('fade-in', 'fade-out');
            element.style.userSelect = 'none';
            element.style.pointerEvents = 'none';
        } else {
            element.classList.replace('fade-out', 'fade-in');
            element.style.userSelect = '';
            element.style.pointerEvents = '';
        }
        });
    </script>

    <script>
        function checkScroll() {
        var element = document.querySelector('.scroll-effect');
        var scrollHeight = document.documentElement.scrollHeight;
        var clientHeight = document.documentElement.clientHeight;
        var scrollPosition = window.scrollY + clientHeight;
    
        if (scrollHeight <= clientHeight || scrollPosition >= scrollHeight) {
            element.style.display = 'none';
        } else {
            element.style.display = 'block';
        }
        }
    
        window.addEventListener('scroll', checkScroll);
        window.addEventListener('resize', checkScroll);
        document.addEventListener('DOMContentLoaded', checkScroll);


        document.addEventListener("DOMContentLoaded", () => {
        const newsTab = document.getElementById("news-tab");
        const newsHeader = document.getElementById("news-header");
        const newsMedia = document.getElementById("news-media");
        const headline = document.getElementById("news-headline");
        const toggleArrow = document.getElementById("toggle-arrow");

        let currentHeightState = "collapsed"; // Aktueller Zustand
        let lastScrollY = window.scrollY;

    // JSON-Daten laden
    fetch("https://fadedcloth.de/JSON/news-data.json?v=1.3")
        .then((response) => response.json())
        .then((data) => {
        // Headline setzen
        headline.textContent = data.headline;

        // Bild oder Video dynamisch setzen
        if (data.mediaType === "video") {
            const video = document.createElement("video");
            video.src = data.media;
            video.autoplay = true;
            video.loop = true;
            video.muted = true;
            video.classList.add('media');
            video.id = 'media';
            newsMedia.appendChild(video);
        } else {
            const img = document.createElement("img");
            img.src = data.media;
            img.id = 'media';
            img.classList.add('media');
            img.setAttribute('data-tilt', '');
            newsMedia.appendChild(img);
        }

        // Klick auf das Medium öffnet den Link
        newsMedia.addEventListener("click", () => {
            window.open(data.mediaLink, "_blank");
        });
        })
        .catch((error) => {
        console.error("Error loading JSON:", error);
        });

    // Klick-Logik für den Header
    newsHeader.addEventListener("click", () => {
        if (currentHeightState === "collapsed") {
        // Von collapsed -> half-height
        newsTab.classList.remove("collapsed");
        newsTab.classList.add("half-height");
        currentHeightState = "half-height";
        } else if (currentHeightState === "half-height") {
        // Von half-height -> full-height
        newsTab.classList.remove("half-height");
        newsTab.classList.add("full-height");
        currentHeightState = "full-height";
        } else if (currentHeightState === "full-height") {
        // Von full-height -> collapsed
        newsTab.classList.remove("full-height");
        newsTab.classList.add("collapsed");
        currentHeightState = "collapsed";
        }
    });

    // Scroll-Logik: Container verstecken/anzeigen
    window.addEventListener("scroll", () => {
        const currentScrollY = window.scrollY;

        if (currentScrollY > lastScrollY && currentHeightState === "collapsed") {
        // Verstecke Container, wenn nach unten gescrollt wird und er collapsed ist
        newsTab.classList.add("news-hidden");
        } else if (currentScrollY < lastScrollY) {
        // Zeige Container, wenn nach oben gescrollt wird
        newsTab.classList.remove("news-hidden");
        }

        lastScrollY = currentScrollY;
    });
    });




    </script>
  
</head>
<body>

<!--
               @@@@@@@@@@@@@@@@@@@@@@
            @@@@@@@@@@@@@@@@@@@@@@@@@@
          @@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@
        @@@@@@@@@@@
        @@@
        @@
              @@@@@@@@@@@@@@@@@@@
           @@@@@@@@@@@@@@@@@@@@@
          @@@@@@@@@
        @@@@@@@@
        @@@@@
        @@@
        @@@
        @@@             fadedcloth.de
-->
        <a href="https://shop.fadedcloth.de/" class="drop_link top-right">SHOP</a>
    
    
    <div class="logo-container" id="load-container">
        <div id="loader" class="loader-container">
            <l-zoomies size="80" stroke="5" bg-opacity="0.1" speed="1.4" color="white"></l-zoomies>
        </div>
        <div class="video-wrapper" id="videoWrapper">
            <video class="logo" id="load-obj" autoplay loop muted playsinline preload="auto">
                <source src="media/collections/fadedlove.mp4" type="video/mp4">
                BAD BROWSER
            </video>
        </div>
    </div>

    <div class="scroll-text fade-in" onclick="(function() { const newsletterContainer = document.querySelector('.newsletter_form'); const collectionButton = document.querySelector('.collection-button'); if (newsletterContainer && collectionButton) { const newsletterRect = newsletterContainer.getBoundingClientRect(); const collectionRect = collectionButton.getBoundingClientRect(); const middlePosition = window.pageYOffset + ((newsletterRect.top + collectionRect.top) / 2) - (window.innerHeight / 2); window.scrollTo({ top: middlePosition, behavior: 'smooth' }); } })()">VIEW DROPS ↓</div>
    
    <div class="glas-wrapper">
        <div class="drop_container fade-in" id="drops-container">
            <!-- Drop items will be appended here -->
        </div>
    </div>

    <div id="news-tab" class="collapsed">
        <div id="news-header">
          <span id="news-headline">...</span>
          <span id="toggle-arrow">^</span>
        </div>
        <div id="news-media"></div>
    </div>
    

    <!--<div class="buttons-container">
        <button id="button1" class="glass-button" data-target="panel1">COLLECTION</button>
        <button id="button2" class="glass-button" data-target="panel2">INFO</button>
        <button id="button3" class="glass-button" data-target="panel3">NEWSLETTER</button>
    </div>-->
    
    <!-- Panel für Button 1 -->
    <div id="panel1" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel1')">X</button>
        <a href="https://shop.fadedcloth.de/?collection=all&hide=FALSE" class="panel-link">SHOP ALL</a>
        <a href="https://fadedcloth.de/gallery" class="panel-link">GALLERY</a>
        <a href="https://shop.fadedcloth.de/?collection=FADEDLOVE&hide=TRUE" class="panel-link">FADEDLOVE</a>
        <a href="https://fadedcloth.de/" class="panel-link">MAINPAGE</a>
        <button id="collectionButton" class="panel-link">+ COLLECTION</button>
        <div id="collectionsContainer" class="hidden"></div>
    </div>
    
    <!-- Panel für Button 2 -->
    <div id="panel2" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel2')">X</button>
        <div class="social-container">
            <select id="social-select">
                <option value="instagram">INSTAGRAM</option>
                <option value="tiktok">TIKTOK</option>
                <option value="twitter">TWITTER</option>
            </select>
            <a class="underlineonhover" id="social-select-link" href="https://instagram.com/fadedcloth.de">fadedcloth.de</a>
        </div>
        <a href="mailto:help@fadedcloth.de" class="panel-link">CONTACT</a>
        <a href="/legal?id=privacy-policy" class="panel-link">PRIVACY POLICY</a>
        <a href="/legal?id=terms-of-service" class="panel-link">TERMS OF SERVICE</a>
        <div class="copyright">&copy; FADEDCLOTH 2024</div>
    </div>
    
    <!-- Panel für Button 3 (Subscribe Panel) -->
    <div id="panel3" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel3')">X</button>
        <div class="headline">SUBSCRIBE FOR UPDATES</div>
        <form id="emailForm">
            <input 
                type="email" 
                id="email" 
                placeholder="ENTER YOUR EMAIL" 
                class="email-input"
                required 
            />
            <div class="checkbox-container">
                <input type="checkbox" id="termsCheckbox" class="custom-checkbox">
                <label for="termsCheckbox" class="checkbox-label">
                  I ACCEPT THE <a class="href" href="/legal?id=terms-of-service">TERMS</a>
                </label>
            </div>
            <div class="form-buttons">
                <button id="subscribeButton" class="email-button small-button">
                    SUBMIT
                </button>
            </div>
        </form>
    </div>

    <div class="scroll-effect"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
    fetchShopifyDrops();

    async function fetchShopifyDrops() {
        const container = document.getElementById('drops-container');
        const now = new Date();

        const query = `
            {
                collections(first: 50) {
                    edges {
                        node {
                            title
                            handle
                            metafields(namespace: "custom", keys: ["drop", "dropinfo", "dropend"]) {
                                key
                                value
                            }
                        }
                    }
                }
            }
        `;

        try {
            const response = await fetch("https://checkout.fadedcloth.de/api/2023-07/graphql.json", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-Shopify-Storefront-Access-Token": "ed72f09d8742f37356305b6e49310909"
                },
                body: JSON.stringify({ query })
            });

            if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

            const data = await response.json();
            const collections = parseCollections(data.data.collections.edges, now);

            const droppedItems = collections.filter(c => c.state === 'dropped');
            const upcomingDrops = collections.filter(c => c.state === 'upcoming');

            // Create sections
            createSection('Dropped Drops', droppedItems, container);
            addNewsletterInput(container, upcomingDrops.length + 1);
            addCollectionButton(container, upcomingDrops.length + 2);
            createSection('Upcoming Drops', upcomingDrops, container);

            // Add navigation links
            addNavigationLinks(container);
        } catch (error) {
            console.error("Error fetching Shopify drops:", error);
        }
    }

    function parseCollections(edges, now) {
        return edges.map(edge => {
            const metafields = edge.node.metafields.reduce((acc, field) => {
                acc[field.key] = field.value ? new Date(field.value) : null;
                return acc;
            }, {});
            const drop = metafields.drop;
            const dropend = metafields.dropend;
            const state = drop > now ? 'upcoming' : (dropend && dropend > now ? 'active' : 'dropped');
            return {
                title: edge.node.title,
                handle: edge.node.handle,
                drop,
                dropend,
                dropinfo: metafields.dropinfo,
                state
            };
        }).sort((a, b) => (a.drop || Infinity) - (b.drop || Infinity));
    }

    function createSection(title, items, container) {
        const section = document.createElement('div');
        section.className = 'drop_section';

        items.forEach(item => {
            const dropElement = createDropElement(item);
            section.appendChild(dropElement);
        });

        container.appendChild(section);
    }

    function createDropElement({ title, handle, drop, dropinfo, state }) {
        const dropElement = document.createElement('div');
        dropElement.className = `drop_item ${state}`;

        const dropNumber = state === 'upcoming' ? 3 : 1;
        const numberContainer = createNumberContainer(dropNumber);
        dropElement.appendChild(numberContainer);

        const link = document.createElement(state === 'upcoming' ? 'span' : 'a');
        link.className = 'drop_link';
        link.textContent = dropinfo ? `${title} - ${dropinfo}` : title;

        if (state !== 'upcoming') link.href = `https://shop.fadedcloth.de?collection=${handle}`;
        dropElement.appendChild(link);

        return dropElement;
    }

    function createNumberContainer(number) {
        const container = document.createElement('div');
        container.className = 'drop_number_container';

        const hash = document.createElement('div');
        hash.textContent = '#';

        const numberElement = document.createElement('div');
        numberElement.textContent = String(number).padStart(2, '0');

        container.appendChild(hash);
        container.appendChild(numberElement);

        return container;
    }

    function addNewsletterInput(container, nextDropNumber) {
        const newsletterContainer = document.createElement('div');
        newsletterContainer.className = 'drop_item';

        const numberContainer = createNumberContainer(nextDropNumber);
        newsletterContainer.appendChild(numberContainer);

        const form = document.createElement('div');
        form.className = 'newsletter_form';

        const label = document.createElement('div');
        label.textContent = 'ENTER EMAIL:';
        label.className = 'drop_link';

        const input = document.createElement('input');
        input.type = 'email';
        input.placeholder = 'Your email address';
        input.className = 'drop_link';

        form.appendChild(label);
        form.appendChild(input);
        newsletterContainer.appendChild(form);
        container.appendChild(newsletterContainer);
    }

    function addCollectionButton(container, nextDropNumber) {
        const buttonContainer = document.createElement('div');
        buttonContainer.className = 'drop_item';

        const numberContainer = createNumberContainer(nextDropNumber);
        buttonContainer.appendChild(numberContainer);

        const button = document.createElement('div');
        button.textContent = '+ COLLECTION';
        button.className = 'drop_link collection-button';
        button.style.cursor = 'pointer';

        buttonContainer.appendChild(button);
        container.appendChild(buttonContainer);

        button.addEventListener('click', toggleCollectionDisplay);
    }

    function addNavigationLinks(container) {
        const links = [
            { text: 'GALLERY', url: 'https://fadedcloth.de/gallery' },
            { text: 'TERMS OF SERVICE', url: 'https://fadedcloth.de/legal?id=terms-of-service' },
            { text: 'PRIVACY POLICY', url: 'https://fadedcloth.de/legal?id=privacy-policy' }
        ];

        const navSection = document.createElement('div');
        navSection.className = 'navigation_links';

        links.forEach(({ text, url }) => {
            const linkElement = document.createElement('a');
            linkElement.href = url;
            linkElement.textContent = text;
            linkElement.className = 'drop_link';
            navSection.appendChild(linkElement);
        });

        container.appendChild(navSection);
    }
});

    </script>
    
    <script src="scripts/loader.js" defer></script>
    <script src="scripts/social.js?v=1.2" defer></script>
    <script src="scripts/load-buttons.js?v=1.3" defer></script>
    <script src="scripts/animate.js" defer></script> 
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/zoomies.js" defer></script>
    <script src="scripts/subscribe.js?v=1.2" defer></script>
    <script src="scripts/vanilla-tilt.js"></script>
</body>
</html>
