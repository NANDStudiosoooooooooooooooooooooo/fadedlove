<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FADEDCLOTH</title>
    <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:500|IBM+Plex+Sans:300&display=swap" rel="stylesheet">
    <meta name="description" content="The offical FADEDCLOTH site. Subscribe for updates.">
    <script src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js"></script>
    <link rel="stylesheet" href="https://fadedcloth.de/styles/main.css?v=2.83">

    <style>
        body {
            background-color: black;
            margin: 0;
            padding: 0;
            margin-bottom: 0;
            padding-bottom: 0;
            align-items: left !important;
            justify-content: flex-start;
            overflow-y: scroll;
            overflow-x: auto
        }

        .drop_section{
            width: 100%;
        }

        a {
            text-decoration: none;
            color: #84898E;
        }

        .glas-wrapper{
            margin-top: 100vh ;
            display: flex;
            flex-direction: column;
            width: fit-content;
        }

        .drop_container {
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            font-family: monospace;
            color: #84898E;
            display: flex;
            overflow-x: visible;
            overflow-y: visible;
            flex-direction: column;
            align-items: flex-start;
            width: auto;
            text-transform: uppercase;
            position: relative;
            max-width: auto;
            scrollbar-color: #84898E transparent;
            white-space: nowrap;
            
        }

        #blurOverlay { position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0, 0, 0, 0); 
            backdrop-filter: blur(0px); 
            -webkit-backdrop-filter: blur(0px);
            transition: backdrop-filter 0.1s, -webkit-backdrop-filter 0.1s; }

        .drop_container::-webkit-scrollbar {
            height: 6px; /* Set the scrollbar height for horizontal scrolling */
        }
        .drop_container::-webkit-scrollbar-track {
            background: transparent; /* Hide the scrollbar track */
        }
        .drop_container::-webkit-scrollbar-thumb {
            background-color: grey; /* Make the scrollbar handle grey */
            border-radius: 10px; /* Round the scrollbar handle */
            border: 2px solid transparent; /* Create space around the scrollbar handle */
        }

        .drop_container::-webkit-scrollbar-thumb:hover {
            background-color: darkgrey; /* Darken the scrollbar handle on hover */
        }

        .drop_item {
            display: flex;
            align-items: center;
            width: 100%;
            font-size: 4vw;
        }

        .drop_upcoming:hover {
            color: #84898E !important;
        }

        .collection_container{
            display: flex;
            flex-direction: row;
        }

        .collections_container{
            display: flex;
            flex-direction: column;
        }

        .drop_number {
            width: 5%;
            text-align: left;
            z-index: 12000;
        }

        .drop_number_container {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Align to the left */
            justify-content: center;
            height: auto; /* Align vertically with the text */
            font-size: 2.5vw;
            padding-right: 10px;
            padding-left: 5px;
            line-height: 0.8;
            width: 4ch;
        }

        .drop_link {
            font-family: monospace;
            /*color: #84898E;*/
            flex-grow: 1;
            text-align: left;
            white-space: nowrap;
            font-size: 5vw;
            display: block;
            width: auto;
            box-sizing: border-box;
            height: auto;
            line-height: 0.8;
        }

        .drop_link:hover {
            color: white;
            
        }

        .drop_time,
        .drop_countdown {
            width: 25%;
            text-align: left; /* Align to the left */
            white-space: nowrap;
        }

        .active-drop {
            color: #fcddff !important; /* Farbe für den aktiven Drop */
        }

        .active-drop:hover {
            color: white; /* Farbe beim Hover über den aktiven Drop */
        }

        @media (min-width: 501px) {
            .newsletter_form input[type="email"] {
                font-size: 5vw !important;
                line-height: 0.8 !important;
                height: 4vw !important;
            }
            .newsletter_form{
                font-size: 5vw;
                line-height: 0.5;
                flex-direction: row;
            }
        }
        
        @media (max-width: 500px) {
            .drop_item {
                font-size: 8vw; /* Fixed larger size for screens above 500px */
            }
            .drop_link {
                font-size: 8vw;
            }
           .newsletter_form{
                font-size: 8vw;
                line-height: 0.8;
                flex-direction: column;
            } 
            .drop_number_container {
                font-size: 4vw;
            }
            .newsletter_form input[type="email"] {
                MAX-HEIGHT: 7vw;
                font-size: 8vw;
            }
        }

        .newsletter_form {
            display: flex;
            justify-content: flex-start;
        }

        .newsletter_form:hover{
            color: #fcddff !important;
        }

        .ended:hover{
            color: #FFFFFF;
        }

        .submit_button { position: relative; right: 5px; cursor: pointer; height: 100%; line-height: 0.7; margin-left: 5px;}

        .input_wrapper { display: flex; flex-direction: row; }

        /* Stil für das Eingabefeld */
        .newsletter_form input[type="email"] {
            background: none;
            text-overflow: ellipsis;
            border: none;
            color: #fcddff !important;
            text-transform: uppercase;
            width: 100%; /* Breite des Eingabefelds */
            max-width: 1200px;
            outline: none;
            overflow-x: auto; /* Allows horizontal scrolling */
            white-space: nowrap; /* Prevents wrapping of the text */
            text-align: left;
            overflow-x: visible;
            height: 100%;
            /*caret-color: transparent;*/
            /*padding-right: 20px;*/
            padding: 0 !important;
        }

        /* Verstecken des Eingabefelds nach erfolgreicher Eingabe */
        .newsletter_form input[type="email"].hidden {
            display: none;
        }

        .scroll-text {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            text-align: center;
            cursor: pointer;
        }


        .scroll-effect{
            width: 100%;
            height: 140px;
            position: fixed;
            top: 0px;
            background: linear-gradient(to top, transparent, black);
            user-select: none;
            pointer-events: none;
        }

        .dropname {
            width: 7ch;
            min-width: 7ch;
        }
        
        @media (max-width: 500px) {
            .utc {
                display: none;
            }
            .dropname {
                display: none;
            }
            body {
                overflow-x: hidden;
            }
            .product-image {
                height: 6VW;
                MARGIN-LEFT: 20PX;
            }
            .newsletter_number_container{
                transform: translateY(-100%);
            }
        }

        @media (min-width: 501px) {
            .utc {
                display: inline;
            }
            .dropname {
                display: inline;
            }
            body {
                overflow-x: scroll;
            }
            .product-image {
                height: 4VW;
                MARGIN-LEFT: 20PX;
            }
            .newsletter_number_container{
                transform: translateY(0);
            }
        }

        #news-tab {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background-color: #000000;
        border-top: 1px solid white;
        transition: transform 0.4s ease-in-out;
        z-index: 2222;
        }

        #news-header {
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        clip-path: polygon(0% 0%, 98% 0%, 100% 100%, 0% 100%);
        cursor: pointer;
        }

        #news-headline {
        text-transform: uppercase;
        }

        #toggle-arrow {
        font-size: 16px;
        transform: rotate(0deg);
        transition: transform 0.3s ease;
        }

        #news-tab.full-height #toggle-arrow {
        transform: rotate(180deg);
        }

        #news-media {
        width: 100%;
        height: calc(100% - 130px);
        max-height: 100%;
        cursor: pointer;
        align-items: flex-start;
        justify-content: center;
        display: flex;
        }
        /* Zustände */
        #news-tab.collapsed {
            transform: translateY(calc(100% - 50px));
        }

        #news-tab.half-height {
            transform: translateY(calc(50vh - 50px));
        }

        #news-tab.full-height {
            transform: translateY(110px);
        }

        .media {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            cursor: pointer;
        }

    .news-hidden {
        transform: translateY(100%) !important;
    }

    .ended{
        text-decoration: line-through;
        /*pointer-events: none;*/
    }

    .active{
        color: #ffd3fe;
    }
    
    .blur-white{
        filter: blur(2px);
        color: white !important;
    }

    .custom-cursor { position: absolute; width: 1ch; height: 1em; background-color: rgb(230, 230, 230); animation: blink 1s step-end infinite; }

        	@keyframes blink { from, to { opacity: 1; } 50% { opacity: 0; }}

    </style>

    <script>
        window.addEventListener('scroll', function() {
        var scrollPosition = window.scrollY;
        var element = document.querySelector('.scroll-text');
        if (scrollPosition > 0) {
            element.classList.replace('fade-in', 'fade-out');
            element.style.userSelect = 'none';
            element.style.pointerEvents = 'none';
        } else {
            element.classList.replace('fade-out', 'fade-in');
            element.style.userSelect = '';
            element.style.pointerEvents = '';
        }
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        const blurOverlay = document.getElementById('blurOverlay');
        const maxBlur = 15; // max blur px

        window.addEventListener('scroll', () => {
            const scrollPosition = window.scrollY;
            const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
            const blurValue = (scrollPosition / documentHeight) * maxBlur;

            blurOverlay.style.backdropFilter = `blur(${blurValue}px)`;
            blurOverlay.style.webkitBackdropFilter = `blur(${blurValue}px)`;
        });
    });
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {
    const newsTab = document.getElementById("news-tab");
    const newsHeader = document.getElementById("news-header");
    const newsMedia = document.getElementById("news-media");
    const headline = document.getElementById("news-headline");

    let currentHeightState = "collapsed"; // Aktueller Zustand
    let lastScrollY = window.scrollY;
    let lastShownScrollY = window.scrollY; // Letzte Scroll-Position, bei der das Element versteckt wurde

    const API_URL = "https://checkout.fadedcloth.de/api/2023-04/graphql.json";
    const STOREFRONT_TOKEN = "ed72f09d8742f37356305b6e49310909";

    // Funktion zum Abrufen der Blog-Posts
    async function fetchLatestBlogPost() {
        const query = `
        {
            blog(handle: "announcement") {
                articles(first: 1) {
                    edges {
                        node {
                            title
                            onlineStoreUrl
                            image {
                                originalSrc
                                altText
                            }
                            metafields(identifiers: [
                                { namespace: "announcement", key: "link" }
                            ]) {
                                key
                                value
                            }
                        }
                    }
                }
            }
        }`;

        const response = await fetch(API_URL, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-Shopify-Storefront-Access-Token": STOREFRONT_TOKEN,
            },
            body: JSON.stringify({ query }),
        });

        const result = await response.json();

        if (result.data.blog && result.data.blog.articles.edges.length > 0) {
            return result.data.blog.articles.edges[0].node;
        } else {
            console.error("No articles found in the announcement blog.");
            return null;
        }
    }

    try {
        // Abrufen des neuesten Blog-Posts
        const latestBlogPost = await fetchLatestBlogPost();

        if (latestBlogPost) {
            // Titel setzen
            headline.textContent = latestBlogPost.title;

            // Bild dynamisch setzen
            const img = document.createElement("img");
            img.src = latestBlogPost.image.originalSrc;
            img.alt = latestBlogPost.image.altText || "Blog Image";
            img.id = "media";
            img.classList.add("media");
            img.setAttribute("data-tilt", "");
            newsMedia.appendChild(img);

            // Klick auf das Medium öffnet den Blog-Link oder das Metafeld-Link
            const blogLink =
                latestBlogPost.metafields[0]?.value || latestBlogPost.onlineStoreUrl;

            newsMedia.addEventListener("click", () => {
                window.open(blogLink, "_blank");
            });
            newsTab.classList.remove("hidden");
        } else {
            // Kein Blog-Post vorhanden -> news-tab ausblenden
            newsTab.classList.add("hidden");
        }
    } catch (error) {
        console.error("Error loading blog post:", error);
        // Bei Fehler -> news-tab ausblenden
        newsTab.classList.add("hidden");
    }

    // Klick-Logik für den Header
    newsHeader?.addEventListener("click", () => {
        if (currentHeightState === "collapsed") {
            // Von collapsed -> half-height
            newsTab.classList.remove("collapsed");
            newsTab.classList.add("half-height");
            currentHeightState = "half-height";
        } else if (currentHeightState === "half-height") {
            // Von half-height -> full-height
            newsTab.classList.remove("half-height");
            newsTab.classList.add("full-height");
            currentHeightState = "full-height";
        } else if (currentHeightState === "full-height") {
            // Von full-height -> collapsed
            newsTab.classList.remove("full-height");
            newsTab.classList.add("collapsed");
            currentHeightState = "collapsed";
        }
    });

    // Scroll-Logik: Container verstecken/anzeigen
    window.addEventListener("scroll", () => {
        const currentScrollY = window.scrollY;

        if (currentScrollY > lastScrollY && currentHeightState === "collapsed") {
            // Verstecke Container, wenn nach unten gescrollt wird und er collapsed ist
            newsTab.classList.add("news-hidden");
        } else if (
            currentScrollY < lastScrollY &&
            currentScrollY < lastShownScrollY - 30 // Mindestens 30px nach oben gescrollt
        ) {
            newsTab.classList.remove("news-hidden");
        }

        lastScrollY = currentScrollY;

        // Speichere Scroll-Position, wenn der Container versteckt wird
        if (newsTab.classList.contains("news-hidden")) {
            lastShownScrollY = currentScrollY;
        }
    });
});
    </script>
  
</head>
<body>

<!--
               @@@@@@@@@@@@@@@@@@@@@@
            @@@@@@@@@@@@@@@@@@@@@@@@@@
          @@@@@@@@@@@@@@@@@@
        @@@@@@@@@@@@@@@@
        @@@@@@@@@@@
        @@@
        @@
              @@@@@@@@@@@@@@@@@@@
           @@@@@@@@@@@@@@@@@@@@@
          @@@@@@@@@
        @@@@@@@@
        @@@@@
        @@@
        @@@
        @@@             fadedcloth.de
-->
        <a href="https://shop.fadedcloth.de/" class="drop_link top-right" onmouseover="this.style.filter=`blur(2px)`;" onmouseout="this.style.filter=`blur(0px)`;">SHOP</a>
    
    
    <div class="logo-container" id="load-container">
        <div id="loader" class="loader-container">
            <l-zoomies size="80" stroke="5" bg-opacity="0.1" speed="1.4" color="white"></l-zoomies>
        </div>
        <div class="video-wrapper" id="videoWrapper">
            <video class="logo" id="load-obj" autoplay loop muted playsinline preload="auto">
                
                <source src="https://cdn.shopify.com/videos/c/o/v/98309ce66f8641dea5e579d4f1a8a4d9.mp4" type="video/mp4">
                <source src="https://cdn.shopify.com/videos/c/o/v/696856536feb451699e4337ac233c8a9.webm" type="video/webm">
                BAD BROWSER
            </video>
        </div>
    </div>

    <div id="blurOverlay"></div>

    <div class="scroll-text fade-in" onclick="(function() { const newsletterContainer = document.querySelector('.newsletter_form'); const collectionButton = document.querySelector('.collection-button'); if (newsletterContainer && collectionButton) { const newsletterRect = newsletterContainer.getBoundingClientRect(); const collectionRect = collectionButton.getBoundingClientRect(); const middlePosition = window.pageYOffset + ((newsletterRect.top + collectionRect.top) / 2) - (window.innerHeight / 2); window.scrollTo({ top: middlePosition, behavior: 'smooth' }); } })()">VIEW DROPS ↓</div>
    
    <div class="glas-wrapper">
        <div class="drop_container fade-in" id="drops-container">
            <!-- Drop items will be appended here -->
        </div>
    </div>

    <div id="news-tab" class="collapsed hidden">
        <div id="news-header">
          <span id="news-headline"></span>
          <span id="toggle-arrow">^</span>
        </div>
        <div id="news-media"></div>
    </div>

    <div class="text-box top-left"><a href="https://fadedcloth.de">fadedcloth.de</a></div>
    

    <!--<div class="buttons-container">
        <button id="button1" class="glass-button" data-target="panel1">COLLECTION</button>
        <button id="button2" class="glass-button" data-target="panel2">INFO</button>
        <button id="button3" class="glass-button" data-target="panel3">NEWSLETTER</button>
    </div>-->
    
    <!-- Panel für Button 1 -->
    <div id="panel1" style="bottom: 20px;" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel1')">X</button>
        <a href="https://fadedcloth.de/gallery" class="panel-link">GALLERY</a>
        <a href="https://fadedcloth.de/" class="panel-link">MAINPAGE</a>
        <button id="collectionButton" class="panel-link">+ COLLECTION</button>
        <div id="collectionsContainer" class="hidden"></div>
    </div>
    
    <!-- Panel für Button 2 -->
    <div id="panel2" style="bottom: 20px;" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel2')">X</button>
        <div class="social-container">
            <select id="social-select">
                <option value="instagram">INSTAGRAM</option>
                <option value="tiktok">TIKTOK</option>
                <option value="twitter">TWITTER</option>
            </select>
            <a class="underlineonhover" id="social-select-link" href="https://instagram.com/fadedcloth.de">fadedcloth.de</a>
        </div>
        <a href="mailto:help@fadedcloth.de" class="panel-link">CONTACT</a>
        <a href="/legal?id=privacy-policy" class="panel-link">PRIVACY POLICY</a>
        <a href="/legal?id=terms-of-service" class="panel-link">TERMS OF SERVICE</a>
        <div class="copyright">&copy; FADEDCLOTH 2024</div>
    </div>
    
    <!-- Panel für Button 3 (Subscribe Panel) -->
    <div id="panel3" style="bottom: 20px;" class="glass-panel hidden">
        <button class="close-btn" onclick="togglePanel('panel3')">X</button>
        <div class="headline">SUBSCRIBE FOR UPDATES</div>
        <form id="emailForm">
            <input 
                type="email" 
                id="email" 
                placeholder="ENTER YOUR EMAIL" 
                class="email-input"
                required 
            />
            <div class="checkbox-container">
                <input type="checkbox" id="termsCheckbox" class="custom-checkbox">
                <label for="termsCheckbox" class="checkbox-label">
                  I ACCEPT THE <a class="href" href="/legal?id=terms-of-service">TERMS</a>
                </label>
            </div>
            <div class="form-buttons">
                <button id="subscribeButton" class="email-button small-button">
                    SUBMIT
                </button>
            </div>
        </form>
    </div>

    <div class="scroll-effect"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
        fetchShopifyDrops();

        async function fetchShopifyDrops() {
    const container = document.getElementById('drops-container');
    const now = new Date();

    // Shopify GraphQL query to get collections with metafields drop, dropend, isdrop, dropinfo, link and first product image
    const query = `
        {
            collections(first: 50) {
                edges {
                    node {
                        title
                        handle
                        metafields(identifiers: [
                            {namespace: "custom", key: "drop"}, 
                            {namespace: "custom", key: "dropend"}, 
                            {namespace: "custom", key: "isdrop"}, 
                            {namespace: "custom", key: "dropinfo"},
                            {namespace: "custom", key: "link"}
                        ]) {
                            key
                            value
                        }
                        products(first: 1) {
                            edges {
                                node {
                                    images(first: 1) {
                                        edges {
                                            node {
                                                src
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    `;

    try {
        const response = await fetch("https://checkout.fadedcloth.de/api/2023-07/graphql.json", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-Shopify-Storefront-Access-Token": "ed72f09d8742f37356305b6e49310909"
            },
            body: JSON.stringify({ query })
        });

        if (!response.ok) throw new Error(`HTTP error! Status: ${response.status}`);

        const data = await response.json();

        if (!data.data || !data.data.collections || !data.data.collections.edges) {
            throw new Error("No collections found in the response.");
        }

        const collections = data.data.collections.edges
            .map(edge => {
                const collectionNode = edge.node;

                // Ensure metafields are available
                const metafields = Array.isArray(collectionNode.metafields) ? collectionNode.metafields : [];

                // Convert metafields array to an object
                const metafieldsObj = metafields.reduce((acc, metafield) => {
                    if (metafield && metafield.key) {
                        acc[metafield.key] = metafield.value;
                    }
                    return acc;
                }, {});

                if (metafieldsObj['isdrop'] !== 'true') {
                    return null;
                }

                const drop = metafieldsObj['drop'] ? new Date(metafieldsObj['drop']) : null;
                const dropend = metafieldsObj['dropend'] ? new Date(metafieldsObj['dropend']) : null;

                if (!drop || !dropend) {
                    return null;
                }

                // Get first product image
                const productImage = collectionNode.products.edges[0]?.node.images.edges[0]?.node.src || null;

                return {
                    title: collectionNode.title,
                    handle: collectionNode.handle,
                    drop: drop,
                    dropend: dropend,
                    dropinfo: metafieldsObj['dropinfo'] || null,
                    link: metafieldsObj['link'] || null,
                    productImage: productImage
                };
            })
            .filter(collection => collection !== null)
            .sort((a, b) => a.drop - b.drop);

        const upcomingDrops = [];
        const droppedItems = [];

        collections.forEach((collection, index) => {
            const isUpcoming = collection.drop > now;
            const dropElement = document.createElement('div');
            dropElement.className = 'drop_item';
            dropElement.setAttribute('data-drop-date', collection.drop ? collection.drop.toISOString() : "");

            const dropNumberContainer = document.createElement('div');
            dropNumberContainer.className = 'drop_number_container';
            const dropNumberHash = document.createElement('div');
            dropNumberHash.textContent = '#';
            const dropNumber = document.createElement('div');
            dropNumber.textContent = String(index + 1).padStart(2, '0');
            dropNumberContainer.appendChild(dropNumberHash);
            dropNumberContainer.appendChild(dropNumber);
            dropElement.appendChild(dropNumberContainer);

            const dropLink = document.createElement(isUpcoming ? 'span' : 'a');
            dropLink.className = 'drop_link';

            if (isUpcoming) {
                handleCountdown(
                    dropLink,
                    collection.drop,
                    collection.title,
                    formatUpcomingDate(collection.drop),
                    collection.dropinfo,
                    collection.handle
                );
                upcomingDrops.push(dropElement);
            } else {
                const dropinfoText = collection.dropinfo ? ` - ${collection.dropinfo}` : '';
                dropLink.textContent = `${collection.title}${dropinfoText}`;

                // Use custom link if it exists and is valid
                const customLink = collection.link ? collection.link : `https://shop.fadedcloth.de?collection=${collection.handle}`;
                dropLink.href = customLink;

                if (collection.productImage) {
                    // Create an image element and append it next to the drop link
                    const productImageElement = document.createElement('img');
                    productImageElement.src = collection.productImage;
                    productImageElement.alt = `${collection.title} product image`;
                    productImageElement.className = 'product-image';
                    productImageElement.classList.add(`floating`);
                    dropLink.appendChild(productImageElement);
                }

                droppedItems.push(dropElement);
            }

            dropElement.appendChild(dropLink);
            container.appendChild(dropElement);

            if (collection.dropend && collection.dropend < now) {
                dropLink.classList.add('ended');
            } else if (!isUpcoming) {
                dropLink.classList.add('active');
            }
        });

        createSection('Dropped Drops', droppedItems);
        addNewsletterInput('>>>');
        addCollectionButton('///');
        createSection('Upcoming Drops', upcomingDrops);
        createSection('Navigation', nav);

    } catch (error) {
        console.error("Error fetching Shopify drops:", error);
    }
}

        const nav = [
            createLinkElement('GALLERY', 'https://fadedcloth.de/gallery'),
            createLinkElement('TERMS OF SERVICE', 'https://fadedcloth.de/legal?id=terms-of-service'),
            createLinkElement('PRIVACY POLICY', 'https://fadedcloth.de/legal?id=privacy-policy')
        ];
        function createLinkElement(text, url) {
            const dropElement = document.createElement('div');
            dropElement.className = 'drop_item';
            const dropNumberContainer = document.createElement('div');
            dropNumberContainer.className = 'drop_number_container';
            const placeholderTag = document.createElement('a');
            dropNumberContainer.appendChild(placeholderTag);
            const link = document.createElement('a');
            placeholderTag.textContent = '///';
            link.className = 'drop_link';
            link.href = url;
            link.textContent = text;
            dropElement.appendChild(dropNumberContainer);
            dropElement.appendChild(link);
            return dropElement;
        }

        const allowedTitles = ['Navigation']; //add all section-titels for ↗ at hover

        function createSection(title, items) {
            const container = document.getElementById('drops-container');
            const section = document.createElement('div');
            section.className = 'drop_section';

            section.dataset.title = title;

            items.forEach(item => section.appendChild(item));
            container.appendChild(section);
            addHoverEffectToLinksForTitles(container, allowedTitles);
        }

        function addHoverEffectToLinksForTitles(container, allowedTitles) {
            // Event-Listener für Mouseover und Mouseout auf dem Container
            container.addEventListener('mouseover', (event) => {
                if (event.target.classList.contains('drop_link')) {
                    const section = event.target.closest('.drop_section'); // Finde die übergeordnete Section
                    const title = section ? section.dataset.title : null; // Hole den Titel der Section

                    // Prüfe, ob der Titel in der Liste erlaubt ist
                    if (allowedTitles.includes(title)) {
                        if (!event.target.classList.contains('hovered')) {
                            event.target.innerHTML += '↗';
                            event.target.classList.add('hovered');
                        }
                    }
                }
            });

            container.addEventListener('mouseout', (event) => {
                if (event.target.classList.contains('drop_link')) {
                    const section = event.target.closest('.drop_section'); // Finde die übergeordnete Section
                    const title = section ? section.dataset.title : null; // Hole den Titel der Section

                    // Prüfe, ob der Titel in der Liste erlaubt ist
                    if (allowedTitles.includes(title)) {
                        if (event.target.classList.contains('hovered')) {
                            event.target.innerHTML = event.target.innerHTML.replace('↗', '');
                            event.target.classList.remove('hovered');
                        }
                    }
                }
            });
        }

        // Function to handle the countdown and update on expiry
        function handleCountdown(dropLink, endTime, title, formattedDate, dropinfo, handle) {
        // Erstelle separate Elemente für die Anzeige
        const dropnameElement = document.createElement("span");
        const countdownElement = document.createElement("span");
        const dateElement = document.createElement("span");
        const utcElement = document.createElement("span");
        const dropInfoElement = document.createElement("span");

        dropnameElement.classList.add("dropname");
        countdownElement.classList.add("countdown");
        dateElement.classList.add("date");
        utcElement.classList.add("utc");
        dropInfoElement.classList.add("drop-info");

        // Set initial display content
        dateElement.textContent = formattedDate; // Originaldatum
        utcElement.textContent = " MEZ";
        
        // Fügt alle Elemente zum Link hinzu
        dropLink.appendChild(dropnameElement);
        dropLink.appendChild(countdownElement);
        dropLink.appendChild(dateElement);
        dropLink.appendChild(utcElement);
        dropLink.appendChild(dropInfoElement);

        // Intervall für das Countdown-Update
        const countdownInterval = setInterval(() => {
        const now = new Date().getTime();
        const distance = endTime - now;

        // Countdown-Format aktualisieren
        countdownElement.textContent = `${getExtendedCountdown(endTime)}`;

        dropnameElement.textContent = ``; //${title} 
        
        // Bildschirmabhängige Anzeige anpassen
        if (window.innerWidth < 501) {
            const dropDate = new Date(endTime);
            const month = String(dropDate.getMonth() + 1).padStart(2, '0');
            const day = String(dropDate.getDate()).padStart(2, '0');
            
            // Nur Countdown und Datum anzeigen
            dateElement.textContent = ` ${month}/${day}`;
            utcElement.style.display = "none";
        } else {
            dateElement.textContent = ` ${formattedDate}`;
            utcElement.style.display = "inline";
        }

        // Bei Ablauf des Countdowns aktualisieren
        if (distance < 0) {
            clearInterval(countdownInterval);
            dropLink.textContent = dropinfo ? `${title} - ${dropinfo}` : title;
            dropLink.href = `https://shop.fadedcloth.de?collection=${handle}`;
            dropLink.style.pointerEvents = 'auto';
            dropLink.onclick = () => {
                window.location.href = dropLink.href;
            };
        } else {
            dropLink.style.pointerEvents = 'none';
        }
    }, 1000);
}
    
            function formatUpcomingDate(date) {
                const options = {
                    weekday: 'short',
                    month: 'short',
                    day: '2-digit',
                    hour: '2-digit',
                    hour12: true
                };
                return new Intl.DateTimeFormat('en-US', options).format(date).replace(/,\s/g, ' ').replace(/ (\w{2})$/, '$1').trim();
            }
    
            function getExtendedCountdown(date) {
                const now = new Date();
                const diff = date - now;
                const weeks = Math.floor(diff / (1000 * 60 * 60 * 24 * 7));
                const days = Math.floor((diff % (1000 * 60 * 60 * 24 * 7)) / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                return `${String(weeks).padStart(2, '0')}:${String(days).padStart(2, '0')}:${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }

            function addNewsletterInput(nextDropNumber) {
                nextDropNumber = String(nextDropNumber); // Wandelt nextDropNumber in einen String um

                const container = document.getElementById('drops-container');
                const newsletterContainer = document.createElement('div');
                newsletterContainer.className = 'drop_item';
                newsletterContainer.classList.add('active-drop');

                const dropNumberContainer = document.createElement('div');
                dropNumberContainer.className = 'drop_number_container';
                dropNumberContainer.classList.add('newsletter_number_container')

                if (nextDropNumber.includes('/') || nextDropNumber.includes('>')) {
                    // Fügt nur den //-Link ein, wenn nextDropNumber das Zeichen '/' enthält
                    const dropNumberLink = document.createElement('a');
                    dropNumberLink.textContent = nextDropNumber;
                    dropNumberContainer.appendChild(dropNumberLink);
                } else {
                    // Standardanzeige mit # und Drop-Nummer
                    const dropNumberHash = document.createElement('div');
                    dropNumberHash.textContent = '#';
                    const dropNumber = document.createElement('div');
                    dropNumber.textContent = nextDropNumber.padStart(2, '0');

                    dropNumberContainer.appendChild(dropNumberHash);
                    dropNumberContainer.appendChild(dropNumber);
                }

                newsletterContainer.appendChild(dropNumberContainer);

                const newsletterLabel = document.createElement('div');
                newsletterLabel.className = 'drop_link';
                newsletterLabel.textContent = 'ENTER EMAIL:';

                const emailInput = document.createElement('input');
                emailInput.id = 'email';
                emailInput.className = 'drop_link';
                emailInput.setAttribute('type', 'email');
                emailInput.setAttribute('placeholder', '');

                const submitButton = document.createElement('div');
                submitButton.className = 'submit_button hidden';
                submitButton.textContent = '>';

                //const customCursor = document.createElement('div'); customCursor.id = 'customCursor'; customCursor.className = 'custom-cursor';

                const inputWrapper = document.createElement('div'); 
                inputWrapper.className = 'input_wrapper'; 
                inputWrapper.appendChild(emailInput); inputWrapper.appendChild(submitButton); //inputWrapper.appendChild(customCursor);

                const newsletterForm = document.createElement('div');
                newsletterForm.className = 'newsletter_form';
                newsletterForm.appendChild(newsletterLabel);
                newsletterForm.appendChild(inputWrapper);

                newsletterContainer.appendChild(newsletterForm);
                container.appendChild(newsletterContainer);

                emailInput.addEventListener('input', function () { if (emailInput.value.trim() === '') { submitButton.classList.add('hidden'); } else { submitButton.classList.remove('hidden'); } 
                //updateCursor(); 
            });

                emailInput.addEventListener('keypress', function (event) {
                    if (event.key === 'Enter') {
                        event.preventDefault();
                        processSubscription(emailInput.value, newsletterLabel, emailInput);
                    }
                });

                submitButton.addEventListener('click', function () {
                    processSubscription(emailInput.value, newsletterLabel, emailInput);
                });
            }




        async function getCollections() {
    const query = `
        {
            collections(first: 50) {
                edges {
                    node {
                        title
                        handle
                    }
                }
            }
        }
    `;

    try {
        const response = await fetch("https://checkout.fadedcloth.de/api/2023-07/graphql.json", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-Shopify-Storefront-Access-Token": "ed72f09d8742f37356305b6e49310909"
            },
            body: JSON.stringify({ query })
        });

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const data = await response.json();
        return data.data.collections.edges.map(edge => edge.node); // Gibt die Collections zurück
    } catch (error) {
        console.error("Fehler beim Abrufen der Collections:", error);
        return []; // Gibt ein leeres Array zurück bei einem Fehler
    }
}

    
async function addCollectionButton(dropCount) {
    dropCount = String(dropCount); // Wandelt dropCount in einen String um

    const container = document.getElementById('drops-container');

    // Erstelle einen Button-Container für die COLLECTION
    const buttonContainer = document.createElement('div');
    buttonContainer.className = 'drop_item';
    buttonContainer.classList.add('active-drop');

    // Drop-Nummer für den COLLECTION-Button
    const collectionNumberContainer = document.createElement('div');
    collectionNumberContainer.className = 'drop_number_container';

    if (dropCount.includes('/')) {
        // Falls dropCount '/' enthält, wird nur ein //-Link eingefügt
        const collectionNumberLink = document.createElement('a');
        collectionNumberLink.textContent = dropCount;
        collectionNumberContainer.appendChild(collectionNumberLink);
    } else {
        const collectionNumberHash = document.createElement('div');
        collectionNumberHash.textContent = '#';
        const collectionNumber = document.createElement('div');
        collectionNumber.textContent = String(parseInt(dropCount) + 1).padStart(2, '0');
        collectionNumberContainer.appendChild(collectionNumberHash);
        collectionNumberContainer.appendChild(collectionNumber);
    }

    buttonContainer.appendChild(collectionNumberContainer);

    // COLLECTION-Button
    const collectionButton = document.createElement('div');
    collectionButton.className = 'drop_link';
    collectionButton.classList.add('collection-button');
    collectionButton.textContent = '+ COLLECTION';
    collectionButton.style.cursor = 'pointer';

    buttonContainer.appendChild(collectionButton);
    container.appendChild(buttonContainer);

    // Container für die Collections
    const collectionsContainer = document.createElement('div');
    collectionsContainer.className = 'collections_container';
    collectionsContainer.style.display = 'none'; // Unsichtbar beim Laden
    container.appendChild(collectionsContainer);

    // Lade die Collections von Shopify
    const collections = await getCollections(); // Implementiere diese Funktion

    // Erstelle Links für jede Collection
    collections.forEach((collection) => {
        // Überprüfen, ob 'drop' nicht im Handle enthalten ist
        if (!collection.handle.includes('drop')) {
            const collectionLink = document.createElement('a');
            collectionLink.className = 'drop_link';
            collectionLink.href = `https://shop.fadedcloth.de/?collection=${collection.handle}&hide=TRUE`;
            collectionLink.textContent = collection.title; // Titel der Collection als Linktext
            collectionLink.target = '';

            // Container für den Collection-Link (mit Platzhalter für die Nummer)
            const collectionContainer = document.createElement('div');
            collectionContainer.className = 'drop_item';
            collectionContainer.classList.add('collection_container');

            // Platzhalter für die Nummer (00, unsichtbar)
            const placeholderNumberContainer = document.createElement('div');
            placeholderNumberContainer.className = 'drop_number_container';
            placeholderNumberContainer.style.visibility = 'hidden'; // Unsichtbar
            const placeholderNumberHash = document.createElement('div');
            placeholderNumberHash.textContent = '#';
            const placeholderNumber = document.createElement('div');
            placeholderNumber.textContent = '00'; // Platzhalter-Nummer

            placeholderNumberContainer.appendChild(placeholderNumberHash);
            placeholderNumberContainer.appendChild(placeholderNumber);
            collectionContainer.appendChild(placeholderNumberContainer);

            collectionContainer.appendChild(collectionLink);
            collectionsContainer.appendChild(collectionContainer);
        }
    });

    // Event-Listener für den Button
    collectionButton.addEventListener('click', () => {
        const isHidden = collectionsContainer.style.display === 'none';
        collectionsContainer.style.display = isHidden ? 'flex' : 'none';
        collectionButton.textContent = isHidden ? '- COLLECTION' : '+ COLLECTION';
    });
}
    
        // Function to process email validation and submission
        function processSubscription(email, newsletterLabel, emailInput) {
            if (isValidEmail(email)) {
                fetch("https://subscribe.fadedcloth.de/sub", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ email: email })
                })
                .then(response => response.json())
                .then(data => {
                    newsletterLabel.textContent = "THANK YOU!";
                    emailInput.value = '';
                    emailInput.disabled = true;
                    submitButton.classList.add('hidden');
                })
                .catch(error => {
                    console.error("Error:", error);
                });
            } else {
                shakeElement(emailInput);
            }
        }
        });

        //function updateCursor() { const inputRect = emailInput.getBoundingClientRect(); const cursorPosition = emailInput.selectionStart; const textBeforeCursor = emailInput.value.substring(0, cursorPosition); const textWidth = getTextWidth(textBeforeCursor, getComputedStyle(emailInput).font); customCursor.style.left = `${inputRect.left + textWidth + emailInput.scrollLeft}px`; customCursor.style.top = `${inputRect.top + inputRect.height}px`; } function getTextWidth(text, font) { const canvas = document.createElement('canvas'); const context = canvas.getContext('2d'); context.font = font; return context.measureText(text).width; }
    </script>
    
    <script src="scripts/loader.js" defer></script>
    <script src="scripts/social.js?v=1.2" defer></script>
    <script src="scripts/load-buttons.js?v=1.47" defer></script>
    <script src="scripts/animate.js" defer></script> 
    <script type="module" src="https://cdn.jsdelivr.net/npm/ldrs/dist/auto/zoomies.js" defer></script>
    <script src="scripts/subscribe.js?v=1.2" defer></script>
    <script src="scripts/vanilla-tilt.js"></script>
</body>
</html>